<!DOCTYPE html>
<html lang="th">
<head>
  <script>
    (function () {
      const user = localStorage.getItem('currentUser') || sessionStorage.getItem('currentUser');
      if (!user) {
        window.location.replace('login.html');
      }
    })();
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KMS - Quiz / Check Point</title>

  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Sarabun',sans-serif;background:#e8eef5;min-height:100vh}
    .container{display:flex;min-height:100vh}

    /* Sidebar (เดสก์ท็อป) */
    .sidebar{
      width:70px;background:linear-gradient(180deg,#5b9bd5 0%,#4a89c8 100%);
      display:flex;flex-direction:column;align-items:center;
      padding-top:20px;gap:10px;position:fixed;height:100vh;z-index:10;
    }
    .sidebar-icon{
      width:50px;height:50px;display:flex;align-items:center;justify-content:center;
      color:rgba(255,255,255,.7);font-size:20px;border-radius:12px;cursor:pointer;
      transition:all .3s ease;text-decoration:none;user-select:none;-webkit-tap-highlight-color:transparent;
    }
    .sidebar-icon:hover,.sidebar-icon.active{background:rgba(255,255,255,.2);color:#fff}
    .sidebar-icon:active{transform:scale(.96)}

    /* Main */
    .main-content{flex:1;padding:0;margin-left:70px}

    /* Header */
    .header{
      background:linear-gradient(135deg,#5b9bd5 0%,#2e75b6 100%);
      padding:60px 40px;text-align:center;
      box-shadow:0 4px 15px rgba(91,155,213,.3);
    }
    .header h1{
      font-size:42px;font-weight:700;color:#fff;margin-bottom:12px;
      text-shadow:0 2px 4px rgba(0,0,0,.2);letter-spacing:1px;
    }
    .header .subtitle{
      font-size:18px;color:rgba(255,255,255,.95);
      max-width:780px;margin:0 auto;line-height:1.7;
    }

    /* Content blocks */
    .content{padding:30px 40px}
    .box{
      background:#fff;border-radius:16px;padding:22px 24px;
      box-shadow:0 4px 15px rgba(0,0,0,.05);margin-bottom:20px;
    }
    .box h3{font-size:16px;font-weight:700;color:#2c3e50;margin-bottom:10px}
    .box p{font-size:14px;color:#556;line-height:1.8}
    .box ol{margin-left:20px;color:#555;line-height:1.9;font-size:14px}
    .box .hint{margin-top:10px;color:#5b9bd5;font-weight:600}

    /* ✅ การ์ดเป็นแถวเดียว (ตามที่คุณต้องการ) */
    .quiz-grid{
      display:grid;
      grid-template-columns:1fr;   /* ✅ 1 คอลัมน์ */
      gap:20px;
      margin-top:12px;

      /* ทำให้ไม่กว้างเกินและอยู่กลางหน้า (ดูเหมือน Learning Path) */
      max-width:900px;
      margin-left:auto;
      margin-right:auto;
    }

    .quiz-card{
      background:#fff;border-radius:16px;padding:18px 18px;
      box-shadow:0 4px 15px rgba(0,0,0,.05);
      transition:all .25s ease;border:2px solid transparent;
      display:flex;flex-direction:column;justify-content:space-between;min-height:170px;
    }
    .quiz-card:hover{
      transform:translateY(-5px);
      box-shadow:0 8px 25px rgba(91,155,213,.2);
      border-color:#5b9bd5;
    }
    .quiz-badge{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 10px;border-radius:999px;
      background:linear-gradient(135deg,#e8f4fc 0%,#d4e9f7 100%);
      color:#2e75b6;font-weight:700;font-size:12px;margin-bottom:10px;width:fit-content;
    }
    .quiz-title{font-size:16px;font-weight:700;color:#2c3e50;margin-bottom:6px}
    .quiz-desc{font-size:13px;color:#7f8c8d;line-height:1.6}

    .btn-start{
      margin-top:14px;display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:11px 14px;border-radius:12px;text-decoration:none;font-weight:700;font-size:14px;color:#fff;
      background:linear-gradient(135deg,#5b9bd5 0%,#4a89c8 100%);
      box-shadow:0 10px 20px rgba(0,0,0,.10);
      transition:all .2s ease;

      width:100%; /* ✅ ปุ่มเต็มความกว้าง (ดูสวยบนมือถือ) */
    }
    .btn-start:hover{transform:translateY(-2px);filter:brightness(1.02)}
    .btn-start:active{transform:translateY(0)}

    .footer{text-align:center;padding:15px 40px;color:#95a5a6;font-size:13px}

    /* ✅ Responsive มือถือ (แก้ปัญหา header โดนเมนูทับ) */
    @media (max-width: 768px){
      .container{flex-direction:column;}

      /* ทำเมนูเป็นแถบบนแบบ Learning Path และ "ไม่ทับ" header */
      .sidebar{
        width:100%;
        height:60px;
        flex-direction:row;
        justify-content:center;
        padding:10px;
        position:fixed;      /* ✅ fixed เพื่อคงอยู่ด้านบน */
        top:0; left:0;
        z-index:1000;
      }

      /* ✅ ดันเนื้อหาลงมาเท่าเมนู 60px */
      .main-content{
        margin-left:0;
        margin-top:60px;     /* ✅ สำคัญ: ทำให้ header อยู่ใต้เมนู */
      }

      .header{padding:36px 18px}
      .header h1{font-size:26px}
      .header .subtitle{font-size:14px}

      .content{padding:18px}

      /* การ์ดกว้างเต็มบนมือถือ */
      .quiz-grid{
        max-width:100%;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Sidebar -->
    <nav class="sidebar">
      <a class="sidebar-icon" data-page="index" href="index.html"><i class="fas fa-home"></i></a>
      <a class="sidebar-icon" data-page="kb" href="knowledge-base.html"><i class="fas fa-book"></i></a>
      <a class="sidebar-icon" data-page="lp" href="learning-path.html"><i class="fas fa-graduation-cap"></i></a>
      <a class="sidebar-icon active" data-page="quiz" href="quiz.html"><i class="fas fa-clipboard-check"></i></a>
      <a class="sidebar-icon" data-page="share" href="share-experience.html"><i class="fas fa-comments"></i></a>
      <a class="sidebar-icon logout" href="#"><i class="fas fa-sign-out-alt"></i></a>
    </nav>

    <main class="main-content">
      <header class="header">
        <h1>Quiz / Check Point</h1>
        <p class="subtitle">
          หน้านี้มีไว้สำหรับทดสอบความเข้าใจ “หลังเรียน Learning Path”<br>
          กรุณาเริ่มทำจาก Quiz 1 และทำตามลำดับจนถึง Quiz 7 (แต่ละกระบวนการมี Kahoot แยก)
        </p>
      </header>

      <section class="content">
        <!-- อธิบาย -->
        <div class="box">
          <h3><i class="fas fa-info-circle" style="color:#5b9bd5;margin-right:8px;"></i> หน้านี้มีไว้ทำอะไร</h3>
          <p>
            แบบทดสอบนี้ใช้สำหรับประเมินความเข้าใจในกระบวนการผลิตยาอมมะแว้ง
            โดยผู้ทำควรเรียนรู้จาก <b>Learning Path</b> ก่อน แล้วจึงทำ Quiz ตามลำดับ
            เพื่อเช็คความพร้อมก่อนปฏิบัติงานจริง
          </p>
          <p class="hint">แนะนำ: ถ้ายังไม่มั่นใจ ให้กลับไปทบทวน Learning Path ก่อนทำแบบทดสอบ</p>
        </div>

        <!-- ขั้นตอน -->
        <div class="box">
          <h3><i class="fas fa-list-check" style="color:#5b9bd5;margin-right:8px;"></i> ขั้นตอนการทำแบบทดสอบ</h3>
          <ol>
            <li>เข้า <b>Learning Path</b> และเลือกกระบวนการที่รับผิดชอบ</li>
            <li>อ่าน Critical Point + ดูเอกสารประกอบ (OPL/WI/Video)</li>
            <li>กลับมาที่หน้า Quiz แล้วเริ่มทำจาก <b>Quiz 1</b> ตามลำดับ</li>
            <li>กรอก <b>ชื่อ/รหัสพนักงาน</b> ใน Kahoot ก่อนเริ่มทำ</li>
            <li>ทำแบบทดสอบให้ครบ และบันทึกผลคะแนนตามที่หัวหน้างานกำหนด</li>
          </ol>
        </div>

        <!-- 7 Cards -->
        <div class="quiz-grid" id="quizContainer"></div>
      </section>

      <footer class="footer">
        <p>Knowledge Management System | ใช้ภายในองค์กรเท่านั้น</p>
      </footer>
    </main>
  </div>

  <script>
    const quizzes = [
      { no: 1, title: "กระบวนการผสมเปียก",   id: "KAHOOT_ID_1", desc: "ทดสอบ Wet Mass / ความชื้น / ความสม่ำเสมอ" },
      { no: 2, title: "กระบวนการแร่งเปียก",  id: "KAHOOT_ID_2", desc: "ทดสอบการแกร่ง/ขึ้นรูปเม็ดเปียกและผลกระทบต่อขั้นตอนถัดไป" },
      { no: 3, title: "กระบวนการอบลมร้อน",  id: "KAHOOT_ID_3", desc: "ทดสอบการควบคุมความชื้นตกค้างและผลเสียเมื่ออบไม่เหมาะสม" },
      { no: 4, title: "กระบวนการแร่งแห้ง",  id: "KAHOOT_ID_4", desc: "ทดสอบการคัดขนาดหลังอบ และผลต่อการไหล/น้ำหนักเม็ด" },
      { no: 5, title: "กระบวนการผสมแห้ง",   id: "KAHOOT_ID_5", desc: "ทดสอบความสม่ำเสมอของสูตร และความเสี่ยงจากการผสมไม่ทั่ว" },
      { no: 6, title: "กระบวนการตอกเม็ดยา", id: "KAHOOT_ID_6", desc: "ทดสอบ defect จาก Compression (แตก/บิ่น/ติดพั้นช์ ฯลฯ)" },
      { no: 7, title: "กระบวนการบรรจุซอง",  id: "KAHOOT_ID_7", desc: "ทดสอบการตรวจขั้นสุดท้ายและการตัดสินใจเมื่อพบ NG ระหว่างบรรจุ" },
    ];

    const container = document.getElementById("quizContainer");

    quizzes.forEach(q => {
      const card = document.createElement("div");
      card.className = "quiz-card";

      const idMissing = !q.id || q.id.startsWith("KAHOOT_ID_");

      card.innerHTML = `
        <div>
          <div class="quiz-badge"><i class="fas fa-clipboard-check"></i> Quiz ${q.no}</div>
          <div class="quiz-title">${q.title}</div>
          <div class="quiz-desc">${q.desc}</div>
        </div>

        <a class="btn-start"
           href="quiz-play.html?k=${encodeURIComponent(q.id)}&title=${encodeURIComponent(q.title)}"
           ${idMissing ? `onclick="alert('ยังไม่ได้ใส่ Kahoot ID ของ Quiz ${q.no}'); return false;"` : ""}>
          <i class="fas fa-play"></i> เริ่มทำแบบทดสอบ
        </a>
      `;
      container.appendChild(card);
    });
  </script>

  <script src="Js"></script>
</body>
</html>
